"""
ç¤ºä¾‹ 09: å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµ
æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨è¶…çº§æ™ºèƒ½ä½“åè°ƒå¤šä¸ªä¸“ä¸šæ™ºèƒ½ä½“å®Œæˆå¤æ‚ä»»åŠ¡
"""

import sys
from pathlib import Path

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°Pythonè·¯å¾„
project_root = Path(__file__).parent.parent
sys.path.insert(0, str(project_root))

from src.core import ModelManager, MemoryManager, PromptEngine
from src.tools import FileSystemTools


def scenario_1_email_and_file():
    """åœºæ™¯1: é‚®ä»¶å¤„ç† + æ–‡ä»¶æ•´ç†"""
    print("\n" + "="*60)
    print("ğŸ“§ åœºæ™¯1: å¤„ç†é‚®ä»¶é™„ä»¶å¹¶æ•´ç†")
    print("="*60)
    
    print("\nç”¨æˆ·è¯·æ±‚: 'ä¸‹è½½ä»Šå¤©çš„é‚®ä»¶é™„ä»¶å¹¶æ•´ç†åˆ°å¯¹åº”æ–‡ä»¶å¤¹'")
    print("\nä»»åŠ¡åˆ†è§£:")
    print("  1ï¸âƒ£ EmailAgent: è·å–ä»Šå¤©çš„é‚®ä»¶")
    print("  2ï¸âƒ£ EmailAgent: ä¸‹è½½é™„ä»¶")
    print("  3ï¸âƒ£ FileAgent: æ‰«æä¸‹è½½ç›®å½•")
    print("  4ï¸âƒ£ FileAgent: æŒ‰ç±»å‹åˆ†ç±»æ–‡ä»¶")
    print("  5ï¸âƒ£ FileAgent: ç§»åŠ¨æ–‡ä»¶åˆ°å¯¹åº”æ–‡ä»¶å¤¹")
    
    print("\næ‰§è¡Œæµç¨‹:")
    steps = [
        ("EmailAgent", "è¿æ¥é‚®ä»¶æœåŠ¡å™¨", "æˆåŠŸ"),
        ("EmailAgent", "ç­›é€‰ä»Šå¤©çš„é‚®ä»¶", "æ‰¾åˆ° 15 å°"),
        ("EmailAgent", "ä¸‹è½½é™„ä»¶", "ä¸‹è½½ 8 ä¸ªæ–‡ä»¶"),
        ("FileAgent", "æ‰«æä¸‹è½½ç›®å½•", "å‘ç° 8 ä¸ªæ–°æ–‡ä»¶"),
        ("FileAgent", "æ–‡ä»¶åˆ†ç±»", "æ–‡æ¡£3ä¸ªï¼Œå›¾ç‰‡4ä¸ªï¼Œå‹ç¼©åŒ…1ä¸ª"),
        ("FileAgent", "åˆ›å»ºç›®æ ‡ç›®å½•", "æˆåŠŸ"),
        ("FileAgent", "ç§»åŠ¨æ–‡ä»¶", "å…¨éƒ¨ç§»åŠ¨å®Œæˆ"),
    ]
    
    for agent, action, result in steps:
        print(f"  [{agent}] {action}... {result}")
    
    print("\nâœ… ä»»åŠ¡å®Œæˆ!")
    print("   - å¤„ç†é‚®ä»¶: 15 å°")
    print("   - ä¸‹è½½é™„ä»¶: 8 ä¸ª")
    print("   - æ•´ç†æ–‡ä»¶: 3 ç±»")


def scenario_2_data_and_doc():
    """åœºæ™¯2: æ•°æ®åˆ†æ + æŠ¥å‘Šç”Ÿæˆ"""
    print("\n" + "="*60)
    print("ğŸ“Š åœºæ™¯2: åˆ†æé”€å”®æ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Š")
    print("="*60)
    
    print("\nç”¨æˆ·è¯·æ±‚: 'åˆ†ææœ¬æœˆé”€å”®æ•°æ®å¹¶ç”ŸæˆPPTæŠ¥å‘Š'")
    print("\nä»»åŠ¡åˆ†è§£:")
    print("  1ï¸âƒ£ DataAgent: è¯»å–é”€å”®æ•°æ®")
    print("  2ï¸âƒ£ DataAgent: æ•°æ®æ¸…æ´—å’Œç»Ÿè®¡")
    print("  3ï¸âƒ£ DataAgent: ç”Ÿæˆå›¾è¡¨")
    print("  4ï¸âƒ£ DocAgent: åˆ›å»ºPPTæ¡†æ¶")
    print("  5ï¸âƒ£ DocAgent: æ’å…¥å›¾è¡¨å’Œæ•°æ®")
    print("  6ï¸âƒ£ DocAgent: æ·»åŠ åˆ†æç»“è®º")
    
    print("\næ‰§è¡Œæµç¨‹:")
    steps = [
        ("DataAgent", "åŠ è½½æ•°æ®", "æˆåŠŸåŠ è½½ 500 æ¡è®°å½•"),
        ("DataAgent", "æ•°æ®éªŒè¯", "å‘ç° 5 æ¡å¼‚å¸¸æ•°æ®"),
        ("DataAgent", "æ•°æ®æ¸…æ´—", "æ¸…æ´—å®Œæˆ"),
        ("DataAgent", "ç»Ÿè®¡åˆ†æ", "è®¡ç®—å…³é”®æŒ‡æ ‡"),
        ("DataAgent", "ç”Ÿæˆå›¾è¡¨", "åˆ›å»º 4 ä¸ªå›¾è¡¨"),
        ("DocAgent", "åˆ›å»ºPPT", "ä½¿ç”¨é»˜è®¤æ¨¡æ¿"),
        ("DocAgent", "æ·»åŠ å°é¢", "æ·»åŠ æ ‡é¢˜å’Œæ—¥æœŸ"),
        ("DocAgent", "æ’å…¥æ•°æ®é¡µ", "æ·»åŠ  4 ä¸ªå›¾è¡¨"),
        ("DocAgent", "æ·»åŠ ç»“è®ºé¡µ", "åŸºäºåˆ†æç»“æœ"),
        ("DocAgent", "ä¿å­˜æ–‡ä»¶", "reports/sales_202510.pptx"),
    ]
    
    for agent, action, result in steps:
        print(f"  [{agent}] {action}... {result}")
    
    print("\nâœ… ä»»åŠ¡å®Œæˆ!")
    print("   - åˆ†ææ•°æ®: 500 æ¡")
    print("   - ç”Ÿæˆå›¾è¡¨: 4 ä¸ª")
    print("   - åˆ›å»ºPPT: 1 ä¸ª")


def scenario_3_knowledge_and_schedule():
    """åœºæ™¯3: çŸ¥è¯†æ£€ç´¢ + ä¼šè®®å®‰æ’"""
    print("\n" + "="*60)
    print("ğŸ“… åœºæ™¯3: å‡†å¤‡ä¼šè®®èµ„æ–™å¹¶å®‰æ’ä¼šè®®")
    print("="*60)
    
    print("\nç”¨æˆ·è¯·æ±‚: 'å‡†å¤‡ä¸‹å‘¨äº§å“è¯„å®¡ä¼šè®®ï¼Œæ•´ç†ç›¸å…³èµ„æ–™'")
    print("\nä»»åŠ¡åˆ†è§£:")
    print("  1ï¸âƒ£ ScheduleAgent: æ£€æŸ¥ä¸‹å‘¨ç©ºé—²æ—¶é—´")
    print("  2ï¸âƒ£ ScheduleAgent: é¢„å®šä¼šè®®å®¤")
    print("  3ï¸âƒ£ KnowledgeAgent: æ£€ç´¢äº§å“æ–‡æ¡£")
    print("  4ï¸âƒ£ KnowledgeAgent: æ•´ç†è¯„å®¡è¦ç‚¹")
    print("  5ï¸âƒ£ EmailAgent: å‘é€ä¼šè®®é€šçŸ¥")
    
    print("\næ‰§è¡Œæµç¨‹:")
    steps = [
        ("ScheduleAgent", "æŸ¥è¯¢ç©ºé—²æ—¶é—´", "å‘¨ä¸‰ä¸‹åˆ2-4ç‚¹å¯ç”¨"),
        ("ScheduleAgent", "æ£€æŸ¥å‚ä¼šäººæ—¥ç¨‹", "å…¨å‘˜å¯å‚åŠ "),
        ("ScheduleAgent", "é¢„å®šä¼šè®®å®¤", "A301 å·²é¢„å®š"),
        ("ScheduleAgent", "åˆ›å»ºæ—¥ç¨‹äº‹ä»¶", "å·²æ·»åŠ åˆ°æ—¥å†"),
        ("KnowledgeAgent", "æœç´¢äº§å“æ–‡æ¡£", "æ‰¾åˆ° 12 ä¸ªç›¸å…³æ–‡æ¡£"),
        ("KnowledgeAgent", "æå–å…³é”®ä¿¡æ¯", "æ•´ç† 5 ä¸ªè¯„å®¡è¦ç‚¹"),
        ("KnowledgeAgent", "ç”Ÿæˆæ‘˜è¦", "åˆ›å»ºè¯„å®¡æ¸…å•"),
        ("EmailAgent", "å‡†å¤‡é€šçŸ¥", "åŒ…å«æ—¶é—´åœ°ç‚¹å’Œèµ„æ–™"),
        ("EmailAgent", "å‘é€é‚®ä»¶", "å·²å‘é€ç»™ 8 ä½å‚ä¼šäºº"),
    ]
    
    for agent, action, result in steps:
        print(f"  [{agent}] {action}... {result}")
    
    print("\nâœ… ä»»åŠ¡å®Œæˆ!")
    print("   - ä¼šè®®æ—¶é—´: å‘¨ä¸‰ 14:00-16:00")
    print("   - ä¼šè®®å®¤: A301")
    print("   - é€šçŸ¥å‘é€: 8 äºº")


def scenario_4_full_workflow():
    """åœºæ™¯4: å®Œæ•´å·¥ä½œæµæ¼”ç¤º"""
    print("\n" + "="*60)
    print("ğŸ”„ åœºæ™¯4: å‘¨æŠ¥å‡†å¤‡å®Œæ•´æµç¨‹")
    print("="*60)
    
    print("\nç”¨æˆ·è¯·æ±‚: 'å‡†å¤‡æœ¬å‘¨å·¥ä½œå‘¨æŠ¥'")
    print("\næ™ºèƒ½ä½“åä½œæµç¨‹:")
    
    # ä»»åŠ¡è§„åˆ’
    print("\nã€ä»»åŠ¡è§„åˆ’ã€‘SuperAgent åˆ†æä»»åŠ¡")
    print("  è¯†åˆ«æ‰€éœ€æ™ºèƒ½ä½“:")
    print("    - DataAgent: ç»Ÿè®¡æœ¬å‘¨å·¥ä½œæ•°æ®")
    print("    - EmailAgent: å›é¡¾æœ¬å‘¨é‡è¦é‚®ä»¶")
    print("    - ScheduleAgent: ç»Ÿè®¡ä¼šè®®æ—¶é—´")
    print("    - DocAgent: ç”Ÿæˆå‘¨æŠ¥æ–‡æ¡£")
    
    # å¹¶è¡Œæ‰§è¡Œ
    print("\nã€å¹¶è¡Œæ‰§è¡Œã€‘å¤šæ™ºèƒ½ä½“åŒæ—¶å·¥ä½œ")
    print("  [DataAgent]")
    print("    â”œâ”€ è¯»å–é¡¹ç›®è¿›åº¦æ•°æ®")
    print("    â”œâ”€ ç»Ÿè®¡å®Œæˆä»»åŠ¡æ•°: 8")
    print("    â””â”€ è®¡ç®—å·¥ä½œæ—¶é•¿: 40å°æ—¶")
    
    print("  [EmailAgent]")
    print("    â”œâ”€ æ‰«ææœ¬å‘¨é‚®ä»¶: 120å°")
    print("    â”œâ”€ ç­›é€‰é‡è¦é‚®ä»¶: 15å°")
    print("    â””â”€ æå–å…³é”®äº‹é¡¹: 5ä¸ª")
    
    print("  [ScheduleAgent]")
    print("    â”œâ”€ ç»Ÿè®¡ä¼šè®®æ¬¡æ•°: 6æ¬¡")
    print("    â”œâ”€ è®¡ç®—ä¼šè®®æ—¶é•¿: 8å°æ—¶")
    print("    â””â”€ æå–é‡è¦å†³è®®: 3æ¡")
    
    # ç»“æœæ±‡æ€»
    print("\nã€ç»“æœæ±‡æ€»ã€‘DocAgent æ•´åˆä¿¡æ¯")
    print("  [DocAgent]")
    print("    â”œâ”€ åˆ›å»ºWordæ–‡æ¡£")
    print("    â”œâ”€ æ·»åŠ å·¥ä½œæ•°æ®")
    print("    â”œâ”€ æ·»åŠ é‚®ä»¶æ‘˜è¦")
    print("    â”œâ”€ æ·»åŠ ä¼šè®®è®°å½•")
    print("    â”œâ”€ ç”Ÿæˆå·¥ä½œè®¡åˆ’")
    print("    â””â”€ ä¿å­˜: reports/weekly_202510_week3.docx")
    
    # æœ€ç»ˆè¾“å‡º
    print("\nã€ä»»åŠ¡å®Œæˆã€‘SuperAgent æ€»ç»“")
    print("  âœ… å‘¨æŠ¥å·²ç”Ÿæˆ")
    print("  ğŸ“Š åŒ…å«å†…å®¹:")
    print("     - å®Œæˆä»»åŠ¡: 8ä¸ª")
    print("     - å·¥ä½œæ—¶é•¿: 40å°æ—¶")
    print("     - é‡è¦é‚®ä»¶: 15å°")
    print("     - ä¼šè®®è®°å½•: 6æ¬¡")
    print("  ğŸ“ æ–‡ä»¶ä½ç½®: reports/weekly_202510_week3.docx")


def scenario_5_error_handling():
    """åœºæ™¯5: é”™è¯¯å¤„ç†å’Œæ¢å¤"""
    print("\n" + "="*60)
    print("âš ï¸  åœºæ™¯5: é”™è¯¯å¤„ç†æ¼”ç¤º")
    print("="*60)
    
    print("\nç”¨æˆ·è¯·æ±‚: 'æ•´ç†æ–‡ä»¶å¹¶å‘é€é‚®ä»¶é€šçŸ¥'")
    print("\næ‰§è¡Œè¿‡ç¨‹:")
    
    steps = [
        ("FileAgent", "æ‰«æç›®å½•", "æˆåŠŸ", "âœ…"),
        ("FileAgent", "æ–‡ä»¶åˆ†ç±»", "æˆåŠŸ", "âœ…"),
        ("FileAgent", "ç§»åŠ¨æ–‡ä»¶", "æˆåŠŸ", "âœ…"),
        ("EmailAgent", "è¿æ¥é‚®ä»¶æœåŠ¡å™¨", "å¤±è´¥: ç½‘ç»œè¶…æ—¶", "âŒ"),
    ]
    
    for agent, action, result, status in steps:
        print(f"  [{agent}] {action}... {result} {status}")
    
    print("\nã€é”™è¯¯å¤„ç†ã€‘SuperAgent åˆ†æé”™è¯¯")
    print("  æ£€æµ‹åˆ°: EmailAgent ç½‘ç»œè¿æ¥å¤±è´¥")
    print("  å†³ç­–: é‡è¯•å‘é€é‚®ä»¶")
    
    print("\nã€é‡è¯•æ‰§è¡Œã€‘")
    retry_steps = [
        ("EmailAgent", "ç­‰å¾… 5 ç§’", "å®Œæˆ", "â³"),
        ("EmailAgent", "é‡æ–°è¿æ¥", "æˆåŠŸ", "âœ…"),
        ("EmailAgent", "å‘é€é€šçŸ¥", "æˆåŠŸ", "âœ…"),
    ]
    
    for agent, action, result, status in retry_steps:
        print(f"  [{agent}] {action}... {result} {status}")
    
    print("\nâœ… ä»»åŠ¡æœ€ç»ˆå®Œæˆ!")
    print("   æ€»è®¡é‡è¯•: 1 æ¬¡")


def main():
    """ä¸»å‡½æ•°"""
    print("\n" + "="*70)
    print("ğŸ¤– å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµç¤ºä¾‹")
    print("="*70)
    
    print("\næœ¬ç¤ºä¾‹å±•ç¤ºä¸åŒæ™ºèƒ½ä½“å¦‚ä½•åä½œå®Œæˆå¤æ‚ä»»åŠ¡")
    print("è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµç¨‹ï¼Œå±•ç¤ºä»»åŠ¡åˆ†è§£å’Œåä½œæ¨¡å¼")
    print()
    
    try:
        scenario_1_email_and_file()
        scenario_2_data_and_doc()
        scenario_3_knowledge_and_schedule()
        scenario_4_full_workflow()
        scenario_5_error_handling()
        
        print("\n" + "="*70)
        print("âœ… æ‰€æœ‰åœºæ™¯æ¼”ç¤ºå®Œæˆ!")
        print("="*70)
        
        print("\nğŸ’¡ åä½œæ¨¡å¼æ€»ç»“:")
        print("   1. ä»»åŠ¡åˆ†è§£ - SuperAgent å°†å¤æ‚ä»»åŠ¡æ‹†åˆ†")
        print("   2. æ™ºèƒ½ä½“é€‰æ‹© - æ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©ä¸“ä¸šæ™ºèƒ½ä½“")
        print("   3. å¹¶è¡Œæ‰§è¡Œ - å¤šä¸ªæ™ºèƒ½ä½“åŒæ—¶å·¥ä½œ")
        print("   4. ç»“æœæ±‡æ€» - æ•´åˆå„æ™ºèƒ½ä½“çš„è¾“å‡º")
        print("   5. é”™è¯¯å¤„ç† - æ£€æµ‹å¤±è´¥å¹¶è‡ªåŠ¨é‡è¯•")
        
        print("\nğŸ¯ æ ¸å¿ƒä¼˜åŠ¿:")
        print("   â€¢ ä¸“ä¸šåˆ†å·¥ - æ¯ä¸ªæ™ºèƒ½ä½“ä¸“æ³¨ç‰¹å®šé¢†åŸŸ")
        print("   â€¢ é«˜æ•ˆåä½œ - å¹¶è¡Œå¤„ç†æå‡æ•ˆç‡")
        print("   â€¢ æ™ºèƒ½å†³ç­– - è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ‰§è¡Œè·¯å¾„")
        print("   â€¢ å®¹é”™èƒ½åŠ› - è‡ªåŠ¨å¤„ç†å¼‚å¸¸æƒ…å†µ")
        print()
        
    except Exception as e:
        print(f"\nâŒ è¿è¡Œå‡ºé”™: {e}")
        import traceback
        traceback.print_exc()


if __name__ == "__main__":
    main()
